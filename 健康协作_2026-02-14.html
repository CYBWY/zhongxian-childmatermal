<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­ä»™æ‘å¥åº·ç®¡ç† Â· å›¾ç‰‡åä½œï¼ˆç»ˆæç‰ˆï¼‰</title>
    <style>
        * { box-sizing: border-box; font-family: "Microsoft YaHei", sans-serif; }
        body { margin: 0; padding: 20px; background: #f0f5ff; }
        .container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 10px; padding: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .header { text-align: center; border-bottom: 3px solid #2c80c5; padding-bottom: 20px; margin-bottom: 30px; }
        .header h1 { color: #2c80c5; margin: 0 0 15px; font-size: 26px; }
        .user-panel { display: flex; justify-content: space-between; background: #f8fbff; padding: 15px; border-radius: 8px; margin-bottom: 20px; flex-wrap: wrap; gap: 15px; }
        .user-info { display: flex; align-items: center; gap: 15px; }
        .user-avatar { width: 40px; height: 40px; border-radius: 50%; background: #2c80c5; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .tabs { display: flex; background: #f1f8ff; border-radius: 8px; padding: 5px; margin-bottom: 20px; flex-wrap: wrap; }
        .tab-button { flex: 1; padding: 12px; background: transparent; border: none; font-weight: bold; border-radius: 6px; cursor: pointer; text-align: center; }
        .tab-button.active { background: #2c80c5; color: white; }
        .action-buttons { display: flex; gap: 10px; flex-wrap: wrap; }
        .btn { background: #2c80c5; color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-size: 15px; white-space: nowrap; }
        .btn:hover { background: #1a6cb3; }
        .btn-small { padding: 6px 12px; font-size: 14px; }
        .btn-success { background: #8BC34A; }
        .btn-warning { background: #ff9800; }
        .btn-danger { background: #f44336; }
        .tab-content { display: none; overflow-x: auto; padding: 20px 0; }
        .tab-content.active { display: block; }
        .table-container { overflow-x: auto; border: 1px solid #ddd; border-radius: 8px; padding: 10px; background: #fdfdfd; }
        .collaborative-table { width: 100%; border-collapse: collapse; min-width: 1000px; }
        .collaborative-table th, .collaborative-table td { border: 1px solid #c1d7ff; padding: 12px 10px; text-align: center; vertical-align: top; position: relative; }
        .collaborative-table th { background: #e3eeff; font-weight: bold; color: #2c80c5; position: sticky; top: 0; }
        .collaborative-table td { background: white; cursor: text; }
        .cell-content { min-height: 40px; word-break: break-word; }
        .cell-image { max-width: 100%; max-height: 150px; margin: 5px 0; border-radius: 4px; cursor: pointer; }
        .image-container { position: relative; display: inline-block; margin: 5px; }
        .image-remove { position: absolute; top: -8px; right: -8px; width: 20px; height: 20px; background: #f44336; color: white; border-radius: 50%; text-align: center; line-height: 20px; font-size: 12px; cursor: pointer; display: none; }
        .image-container:hover .image-remove { display: block; }
        .image-upload-btn { position: absolute; bottom: 5px; right: 5px; background: rgba(44,128,197,0.8); color: white; border: none; border-radius: 50%; width: 28px; height: 28px; font-size: 16px; cursor: pointer; display: none; z-index: 25; line-height: 28px; text-align: center; }
        .collaborative-table td:hover .image-upload-btn { display: block; }  /* é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºç›¸æœºï¼Œæ— éœ€ç¼–è¾‘çŠ¶æ€ */
        .table-title { font-size: 20px; font-weight: bold; margin: 10px 0 20px; color: #2c80c5; border-bottom: 2px solid #e0edff; padding-bottom: 8px; }
        .table-controls { display: flex; justify-content: space-between; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        .notes { background: #f0f9ff; padding: 20px; border-left: 5px solid #2c80c5; border-radius: 8px; margin-top: 40px; }
        .footer { text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #e0e0e0; color: #777; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); align-items: center; justify-content: center; z-index: 1000; }
        .modal.active { display: flex; }
        .modal-content { background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 500px; }
        .modal-input { width: 100%; padding: 12px; margin: 10px 0 20px; border: 1px solid #ddd; border-radius: 6px; }
        .image-viewer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); align-items: center; justify-content: center; z-index: 2000; }
        .image-viewer.active { display: flex; }
        .image-viewer img { max-width: 90%; max-height: 90%; }
        .image-viewer-close { position: absolute; top: 20px; right: 20px; color: white; font-size: 30px; cursor: pointer; background: none; border: none; }
        .message-popup { position: fixed; top: 20px; right: 20px; padding: 15px 20px; border-radius: 8px; color: white; font-weight: bold; z-index: 10000; background: #4CAF50; }
    </style>
</head>
<body>
    <!-- ç™»å½•æ¨¡æ€æ¡†ï¼ˆç®€åŒ–ï¼šç›´æ¥è‡ªåŠ¨ç™»å½•ï¼‰ -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>åŠ å…¥åä½œç¼–è¾‘</h2>
            <p>è¯·è¾“å…¥æ‚¨çš„å§“åï¼š</p>
            <input type="text" id="userNameInput" class="modal-input" value="æ± æ¯“æ³¢">
            <button class="btn" id="joinButton" style="width:100%;">è¿›å…¥</button>
        </div>
    </div>

    <!-- å›¾ç‰‡æŸ¥çœ‹å™¨ -->
    <div class="image-viewer" id="imageViewer">
        <button class="image-viewer-close" id="closeImageViewer">Ã—</button>
        <img id="viewerImage">
    </div>

    <!-- éšè—çš„æ–‡ä»¶è¾“å…¥ -->
    <input type="file" id="imageUploadInput" accept="image/*" style="display:none;">

    <div class="container" id="mainContainer" style="display: block;">
        <div class="header"><h1>ä¸­ä»™æ‘0~6å²å„¿ç«¥ã€å­•äº§å¦‡å¥åº·ç®¡ç† Â· å›¾ç‰‡åä½œ</h1></div>
        <div class="user-panel">
            <div class="user-info"><div class="user-avatar" id="userAvatar">æ± </div><div><span id="userNameDisplay">æ± æ¯“æ³¢</span> (åœ¨çº¿)</div></div>
            <div class="action-buttons">
                <button class="btn btn-success" id="shareButton">åˆ†äº«</button>
                <button class="btn btn-warning" id="saveData">ä¿å­˜</button>
                <button class="btn" id="downloadWord">Word</button>
                <button class="btn" id="downloadHTML">HTML</button>
                <button class="btn btn-danger" id="logoutButton">é€€å‡º</button>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-button" data-tab="child-health">å„¿ç«¥å¥åº·ä½“æ£€</button>
            <button class="tab-button" data-tab="maternal-health">å­•äº§å¦‡å¥åº·ç®¡ç†</button>
            <button class="tab-button active" data-tab="child-tcm">å„¿ç«¥ä¸­åŒ»è¯ç®¡ç†</button>
        </div>

        <!-- å„¿ç«¥å¥åº·ä½“æ£€ -->
        <div id="child-health" class="tab-content">
            <div class="table-title">å„¿ç«¥å¥åº·ä½“æ£€</div>
            <div class="table-controls">
                <button class="btn btn-small btn-secondary" id="addChildRow">+æ·»åŠ è¡Œ</button>
                <button class="btn btn-small btn-danger" id="clearChildRows">æ¸…ç©ºç™½è¡Œ</button>
            </div>
            <div class="table-container">
                <table class="collaborative-table"><thead><tr><th>ç®¡ç†å¯¹è±¡</th><th>æœåŠ¡é¡¹ç›®</th><th>ç¬¬1æ¬¡</th><th>ç¬¬2æ¬¡</th><th>ç¬¬3æ¬¡</th><th>ç¬¬4æ¬¡</th><th>ç¬¬5æ¬¡</th><th>ç¬¬6æ¬¡</th><th>ç¬¬7æ¬¡</th><th>ç¬¬8æ¬¡</th><th>ç¬¬9æ¬¡</th></tr></thead><tbody id="childHealthBody"><tr><td class="editable" contenteditable="true" data-row="0" data-col="0"><div class="cell-content"><span>0~6å²å„¿ç«¥</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="1"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å¥åº·ä½“æ£€</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="2"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å‡ºé™¢3~7å¤©å†…</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="3"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">æ»¡æœˆï¼ˆ28~30å¤©ï¼‰</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="4"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">3æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="5"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">6æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="6"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">8~9æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="7"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">12æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="8"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">18æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="9"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">24æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="10"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">36æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td></tr><tr><td class="editable" contenteditable="true" data-row="1" data-col="0"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="1"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="2"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="3"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="4"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="5"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="6"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="7"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="8"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="9"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="10"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td></tr></tbody></table>
            </div>
        </div>
        <!-- å­•äº§å¦‡å¥åº·ç®¡ç† -->
        <div id="maternal-health" class="tab-content">
            <div class="table-title">å­•äº§å¦‡å¥åº·ç®¡ç†</div>
            <div class="table-controls">
                <button class="btn btn-small btn-secondary" id="addMaternalRow">+æ·»åŠ è¡Œ</button>
                <button class="btn btn-small btn-danger" id="clearMaternalRows">æ¸…ç©ºç™½è¡Œ</button>
            </div>
            <div class="table-container">
                <table class="collaborative-table"><thead><tr><th>ç®¡ç†å¯¹è±¡</th><th>æœåŠ¡é¡¹ç›®</th><th>ç¬¬1æ¬¡</th><th>ç¬¬2æ¬¡</th><th>ç¬¬3æ¬¡</th><th>ç¬¬4æ¬¡</th><th>ç¬¬5æ¬¡</th><th>ç¬¬6æ¬¡</th><th>ç¬¬7æ¬¡</th><th>ç¬¬8æ¬¡</th><th>ç¬¬9æ¬¡</th></tr></thead><tbody id="maternalHealthBody"><tr><td class="editable" contenteditable="true" data-row="0" data-col="0"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å­•äº§å¦‡</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="1"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å¥åº·ç®¡ç†</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="2"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å­•13å‘¨å‰</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="3"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å­•16-24å‘¨</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="4"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å­•24-28å‘¨</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="5"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å­•28-32å‘¨</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="6"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å­•32-36å‘¨</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="7"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">å­•37-40å‘¨</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="8"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">äº§å7å¤©å†…</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="9"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">äº§å28å¤©</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="10"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">äº§å42å¤©</span></div><button class="image-upload-btn">ğŸ“·</button></td></tr><tr><td class="editable" contenteditable="true" data-row="1" data-col="0"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="1"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="2"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="3"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="4"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="5"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="6"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="7"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="8"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="9"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="10"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td></tr><tr><td class="editable" contenteditable="true" data-row="2" data-col="0"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="1"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="2"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="3"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="4"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="5"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="6"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="7"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="8"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="9"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="2" data-col="10"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td></tr></tbody></table>
            </div>
        </div>
        <!-- å„¿ç«¥ä¸­åŒ»è¯ç®¡ç† -->
        <div id="child-tcm" class="tab-content active">
            <div class="table-title">å„¿ç«¥ä¸­åŒ»è¯ç®¡ç†</div>
            <div class="table-controls">
                <button class="btn btn-small btn-secondary" id="addTcmRow">+æ·»åŠ è¡Œ</button>
                <button class="btn btn-small btn-danger" id="clearTcmRows">æ¸…ç©ºç™½è¡Œ</button>
            </div>
            <div class="table-container">
                <table class="collaborative-table"><thead><tr><th>ç®¡ç†å¯¹è±¡</th><th>æœåŠ¡é¡¹ç›®</th><th>ç¬¬1æ¬¡</th><th>ç¬¬2æ¬¡</th><th>ç¬¬3æ¬¡</th><th>ç¬¬4æ¬¡</th><th>ç¬¬5æ¬¡</th><th>ç¬¬6æ¬¡</th><th>ç¬¬7æ¬¡</th><th>ç¬¬8æ¬¡</th><th>ç¬¬9æ¬¡</th></tr></thead><tbody id="childTcmBody"><tr><td class="editable" contenteditable="true" data-row="0" data-col="0"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">0~6å²å„¿ç«¥</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="1"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">ä¸­åŒ»è¯å¥åº·ç®¡ç†</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="2"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">6æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="3"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">12æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="4"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">18æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="5"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">24æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="6"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">30æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="7"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">36æœˆé¾„</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="8"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">---</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="9"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">---</span></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="0" data-col="10"><div class="cell-content"><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, sans-serif; font-size: 14px; background-color: rgb(245, 249, 255);">---</span></div><button class="image-upload-btn">ğŸ“·</button></td></tr><tr><td class="editable" contenteditable="true" data-row="1" data-col="0"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="1"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="2"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="3"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="4"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="5"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="6"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="7"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="8"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="9"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td><td class="editable" contenteditable="true" data-row="1" data-col="10"><div class="cell-content"></div><button class="image-upload-btn">ğŸ“·</button></td></tr></tbody></table>
            </div>
        </div>

        <div class="notes">
            <h3>ä½¿ç”¨è¯´æ˜</h3>
            <ul>
                <li><strong>ä¸Šä¼ å›¾ç‰‡ï¼š</strong>é¼ æ ‡æ‚¬åœåœ¨å•å…ƒæ ¼ä¸Šï¼Œå³ä¸‹è§’ä¼šå‡ºç° ğŸ“· æŒ‰é’®ï¼Œç‚¹å‡»å³å¯é€‰æ‹©æœ¬åœ°å›¾ç‰‡ï¼ˆJPG/PNGï¼‰ã€‚</li>
                <li><strong>ç²˜è´´å›¾ç‰‡ï¼š</strong>åœ¨å•å…ƒæ ¼å†…æŒ‰ Ctrl+V å³å¯ç²˜è´´æˆªå›¾ã€‚</li>
                <li>æ‰€æœ‰ä¿®æ”¹è‡ªåŠ¨ä¿å­˜ï¼Œåˆ·æ–°é¡µé¢ä¸ä¸¢å¤±ã€‚</li>
            </ul>
        </div>
        <div class="footer"><span id="lastSyncTime">æœ€åä¿å­˜: 20:57:30</span></div>
    </div>

    <script>
        (function() {
            // ---------- å…¨å±€å˜é‡ ----------
            let currentUser = 'æ± æ¯“æ³¢';
            // å­˜å‚¨å›¾ç‰‡çš„Map (id -> base64)
            const localImages = new Map();
            // å½“å‰æ­£åœ¨ä¸Šä¼ çš„ç›®æ ‡å•å…ƒæ ¼ï¼ˆç›¸æœºè§¦å‘æ—¶è®°å½•ï¼‰
            let targetCellForUpload = null;

            // é»˜è®¤æ•°æ®
            const defaultData = {
                childHealth: [
                    ['0~6å²å„¿ç«¥','å¥åº·ä½“æ£€','å‡ºé™¢3~7å¤©å†…','æ»¡æœˆ(28~30å¤©)','3æœˆé¾„','6æœˆé¾„','8~9æœˆé¾„','12æœˆé¾„','18æœˆé¾„','24æœˆé¾„','36æœˆé¾„'],
                    ['','','','','','','','','','','']
                ],
                maternalHealth: [
                    ['å­•äº§å¦‡','å¥åº·ç®¡ç†','å­•13å‘¨å‰','å­•16-24å‘¨','å­•24-28å‘¨','å­•28-32å‘¨','å­•32-36å‘¨','å­•37-40å‘¨','äº§å7å¤©å†…','äº§å28å¤©','äº§å42å¤©'],
                    ['','','','','','','','','','','']
                ],
                childTcm: [
                    ['0~6å²å„¿ç«¥','ä¸­åŒ»è¯å¥åº·ç®¡ç†','6æœˆé¾„','12æœˆé¾„','18æœˆé¾„','24æœˆé¾„','30æœˆé¾„','36æœˆé¾„','---','---','---']
                ]
            };
            const tableConfig = [
                { id: 'childHealth', tbodyId: 'childHealthBody', defaultRows: defaultData.childHealth },
                { id: 'maternalHealth', tbodyId: 'maternalHealthBody', defaultRows: defaultData.maternalHealth },
                { id: 'childTcm', tbodyId: 'childTcmBody', defaultRows: defaultData.childTcm }
            ];

            // ---------- åˆå§‹åŒ– ----------
            document.addEventListener('DOMContentLoaded', function() {
                // åŠ è½½æ‰€æœ‰å›¾ç‰‡åˆ°Map
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith('img_')) {
                        localImages.set(key.substring(4), localStorage.getItem(key));
                    }
                }
                // åŠ è½½è¡¨æ ¼æ•°æ®
                loadAllTables();
                // è‡ªåŠ¨ç™»å½•ï¼ˆè·³è¿‡æ¨¡æ€æ¡†ï¼‰
                document.getElementById('loginModal').classList.remove('active');
                document.getElementById('mainContainer').style.display = 'block';
                document.getElementById('userNameDisplay').textContent = currentUser;
                document.getElementById('userAvatar').textContent = currentUser.charAt(0);
                setupEventListeners();
                updateLastSyncTime();
            });

            function loadAllTables() {
                tableConfig.forEach(cfg => {
                    const stored = loadTableData(cfg.id);
                    if (stored) buildTable(cfg.tbodyId, stored);
                    else buildTable(cfg.tbodyId, cfg.defaultRows);
                });
            }

            // ä»localStorageè¯»å–æŸä¸ªè¡¨æ ¼çš„æ•°æ®ï¼Œè¿”å›äºŒç»´æ•°ç»„æˆ–null
            function loadTableData(tableId) {
                const prefix = tableId + '_';
                const rowsMap = new Map(); // row -> Map(col -> {text, images})
                let maxRow = -1;
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith(prefix)) {
                        const parts = key.substring(prefix.length).split('_');
                        if (parts.length === 2) {
                            const r = parseInt(parts[0]), c = parseInt(parts[1]);
                            if (!isNaN(r) && !isNaN(c)) {
                                try {
                                    const data = JSON.parse(localStorage.getItem(key));
                                    if (!rowsMap.has(r)) rowsMap.set(r, new Map());
                                    rowsMap.get(r).set(c, data);
                                    if (r > maxRow) maxRow = r;
                                } catch (e) {}
                            }
                        }
                    }
                }
                if (maxRow < 0) return null;
                // æ„å»ºäºŒç»´æ•°ç»„
                const rows = [];
                for (let r = 0; r <= maxRow; r++) {
                    const rowData = [];
                    for (let c = 0; c < 11; c++) {
                        const cell = rowsMap.get(r)?.get(c) || { text: '', images: [] };
                        rowData.push(cell);
                    }
                    rows.push(rowData);
                }
                return rows;
            }

            // æ ¹æ®äºŒç»´æ•°ç»„æ„å»ºè¡¨æ ¼ (rows: æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ {text, images} æˆ– çº¯æ–‡æœ¬)
            function buildTable(tbodyId, rows) {
                const tbody = document.getElementById(tbodyId);
                tbody.innerHTML = '';
                rows.forEach((row, r) => {
                    const tr = document.createElement('tr');
                    for (let c = 0; c < 11; c++) {
                        const cellData = row[c] || { text: '', images: [] };
                        // å…¼å®¹çº¯æ–‡æœ¬æ ¼å¼
                        let text = '', images = [];
                        if (typeof cellData === 'string') text = cellData;
                        else { text = cellData.text || ''; images = cellData.images || []; }

                        const td = document.createElement('td');
                        td.className = 'editable';
                        td.setAttribute('contenteditable', 'true');
                        td.setAttribute('data-row', r);
                        td.setAttribute('data-col', c);

                        const contentDiv = document.createElement('div');
                        contentDiv.className = 'cell-content';
                        if (text) {
                            const span = document.createElement('span');
                            span.textContent = text;
                            contentDiv.appendChild(span);
                        }
                        // æ·»åŠ å›¾ç‰‡
                        images.forEach(imgId => {
                            const imgData = localImages.get(imgId) || localStorage.getItem('img_' + imgId);
                            if (imgData) {
                                if (!localImages.has(imgId)) localImages.set(imgId, imgData);
                                contentDiv.appendChild(createImageElement(imgId, imgData, td));
                            }
                        });
                        td.appendChild(contentDiv);

                        // ç›¸æœºæŒ‰é’®
                        const uploadBtn = document.createElement('button');
                        uploadBtn.className = 'image-upload-btn';
                        uploadBtn.innerHTML = 'ğŸ“·';
                        uploadBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            // ç›´æ¥è®°å½•ç›®æ ‡å•å…ƒæ ¼ï¼Œå¼¹å‡ºæ–‡ä»¶é€‰æ‹©
                            targetCellForUpload = td;
                            document.getElementById('imageUploadInput').click();
                        });
                        td.appendChild(uploadBtn);
                        tr.appendChild(td);
                    }
                    tbody.appendChild(tr);
                });
            }

            // åˆ›å»ºå›¾ç‰‡å…ƒç´ 
            function createImageElement(imgId, imgData, cell) {
                const container = document.createElement('div');
                container.className = 'image-container';
                const img = document.createElement('img');
                img.className = 'cell-image';
                img.src = imgData;
                img.setAttribute('data-image-id', imgId);
                img.addEventListener('click', () => {
                    document.getElementById('viewerImage').src = imgData;
                    document.getElementById('imageViewer').classList.add('active');
                });
                const removeBtn = document.createElement('div');
                removeBtn.className = 'image-remove';
                removeBtn.innerHTML = 'Ã—';
                removeBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    // ç§»é™¤å›¾ç‰‡
                    container.remove();
                    // åˆ é™¤å­˜å‚¨
                    try { localStorage.removeItem('img_' + imgId); localImages.delete(imgId); } catch(e) {}
                    saveCellData(cell);
                    showMessage('å›¾ç‰‡å·²ç§»é™¤');
                });
                container.appendChild(img);
                container.appendChild(removeBtn);
                return container;
            }

            // ---------- æ ¸å¿ƒï¼šå›¾ç‰‡ä¸Šä¼  ----------
            document.getElementById('imageUploadInput').addEventListener('change', function(e) {
                const file = e.target.files[0];
                const cell = targetCellForUpload; // ä½¿ç”¨ç›¸æœºç‚¹å‡»æ—¶è®°å½•çš„å•å…ƒæ ¼
                if (!file || !cell) {
                    targetCellForUpload = null;
                    return;
                }
                if (!file.type.startsWith('image/')) {
                    showMessage('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶', 'error');
                    targetCellForUpload = null;
                    return;
                }
                if (file.size > 5 * 1024 * 1024) {
                    showMessage('å›¾ç‰‡ä¸èƒ½è¶…è¿‡5MB', 'error');
                    targetCellForUpload = null;
                    return;
                }
                const reader = new FileReader();
                reader.onload = (ev) => {
                    addImageToCell(cell, ev.target.result);
                    targetCellForUpload = null; // é‡Šæ”¾
                };
                reader.readAsDataURL(file);
                e.target.value = '';
            });

            // ç²˜è´´å›¾ç‰‡
            document.addEventListener('paste', function(e) {
                // è·å–å½“å‰æ‹¥æœ‰ç„¦ç‚¹çš„å•å…ƒæ ¼
                const cell = document.activeElement?.closest('td.editable');
                if (!cell) return; // ç„¦ç‚¹ä¸åœ¨å¯ç¼–è¾‘å•å…ƒæ ¼ä¸Š
                const items = e.clipboardData.items;
                for (let i = 0; i < items.length; i++) {
                    if (items[i].type.indexOf('image') !== -1) {
                        e.preventDefault();
                        const blob = items[i].getAsFile();
                        const reader = new FileReader();
                        reader.onload = (ev) => {
                            addImageToCell(cell, ev.target.result);
                        };
                        reader.readAsDataURL(blob);
                        break;
                    }
                }
            });

            // æ·»åŠ å›¾ç‰‡åˆ°å•å…ƒæ ¼
            function addImageToCell(cell, imageData) {
                const contentDiv = cell.querySelector('.cell-content');
                if (!contentDiv) return;
                const imageId = 'img_' + Date.now() + '_' + Math.random().toString(36).substring(2, 10);
                try {
                    localStorage.setItem('img_' + imageId, imageData);
                    localImages.set(imageId, imageData);
                } catch (e) {
                    showMessage('å­˜å‚¨ç©ºé—´ä¸è¶³', 'error');
                    return;
                }
                const imgContainer = createImageElement(imageId, imageData, cell);
                contentDiv.appendChild(imgContainer);
                saveCellData(cell);
                showMessage('å›¾ç‰‡å·²æ·»åŠ ', 'success');
            }

            // ä¿å­˜å•å…ƒæ ¼æ•°æ®åˆ°localStorage
            function saveCellData(cell) {
                const row = cell.getAttribute('data-row');
                const col = cell.getAttribute('data-col');
                const tableId = getTableIdFromCell(cell);
                if (!tableId) return;
                const contentDiv = cell.querySelector('.cell-content');
                let text = '';
                const images = [];
                for (let node of contentDiv.childNodes) {
                    if (node.nodeType === Node.TEXT_NODE) text += node.textContent;
                    else if (node.nodeName === 'SPAN') text += node.textContent;
                    else if (node.nodeName === 'DIV' && node.classList.contains('image-container')) {
                        const img = node.querySelector('img');
                        if (img) images.push(img.getAttribute('data-image-id'));
                    }
                }
                try {
                    localStorage.setItem(`${tableId}_${row}_${col}`, JSON.stringify({ text: text.trim(), images }));
                } catch (e) {}
            }

            function getTableIdFromCell(cell) {
                if (cell.closest('#childHealthBody')) return 'childHealth';
                if (cell.closest('#maternalHealthBody')) return 'maternalHealth';
                if (cell.closest('#childTcmBody')) return 'childTcm';
                return null;
            }

            // ---------- è¾…åŠ©å‡½æ•° ----------
            function showMessage(msg, type = 'info') {
                const old = document.querySelector('.message-popup');
                if (old) old.remove();
                const div = document.createElement('div');
                div.className = 'message-popup';
                div.textContent = msg;
                div.style.backgroundColor = type === 'success' ? '#4CAF50' : (type === 'error' ? '#f44336' : '#2196F3');
                document.body.appendChild(div);
                setTimeout(() => {
                    div.style.opacity = '0';
                    setTimeout(() => div.remove(), 300);
                }, 2500);
            }

            function updateLastSyncTime() {
                document.getElementById('lastSyncTime').textContent = 'æœ€åä¿å­˜: ' + new Date().toLocaleTimeString();
            }

            // ---------- äº‹ä»¶ç»‘å®š ----------
            function setupEventListeners() {
                // é€€å‡ºæŒ‰é’®
                document.getElementById('logoutButton').addEventListener('click', () => {
                    if (confirm('é€€å‡ºç™»å½•ï¼Ÿ')) location.reload();
                });

                // ä¿å­˜æŒ‰é’®
                document.getElementById('saveData').addEventListener('click', () => {
                    saveAllData();
                    showMessage('æ•°æ®å·²ä¿å­˜', 'success');
                });

                // ä¸‹è½½HTML
                document.getElementById('downloadHTML').addEventListener('click', () => {
                    const html = document.documentElement.outerHTML;
                    const blob = new Blob([html], { type: 'text/html' });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = `å¥åº·åä½œ_${new Date().toISOString().slice(0,10)}.html`;
                    a.click();
                    URL.revokeObjectURL(a.href);
                });

                // ä¸‹è½½Word (ç®€å•ç¤ºä¾‹)
                document.getElementById('downloadWord').addEventListener('click', () => {
                    const content = 'ä¸­ä»™æ‘å¥åº·ç®¡ç†æ•°æ®...'; // å¯è‡ªè¡Œæ‰©å±•
                    const blob = new Blob([content], { type: 'application/msword' });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = 'å¥åº·ç®¡ç†.doc';
                    a.click();
                    URL.revokeObjectURL(a.href);
                });

                // åˆ†äº«æŒ‰é’®
                document.getElementById('shareButton').addEventListener('click', () => {
                    alert('è¯·å¤åˆ¶å½“å‰é¡µé¢é“¾æ¥åˆ†äº«ç»™å¥½å‹ã€‚');
                });

                // æ ‡ç­¾åˆ‡æ¢
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                        document.getElementById(this.dataset.tab).classList.add('active');
                    });
                });

                // æ·»åŠ è¡Œ
                document.getElementById('addChildRow').addEventListener('click', () => addRow('childHealthBody'));
                document.getElementById('addMaternalRow').addEventListener('click', () => addRow('maternalHealthBody'));
                document.getElementById('addTcmRow').addEventListener('click', () => addRow('childTcmBody'));

                // æ¸…ç©ºç™½è¡Œ
                document.getElementById('clearChildRows').addEventListener('click', () => clearEmptyRows('childHealthBody', 'childHealth'));
                document.getElementById('clearMaternalRows').addEventListener('click', () => clearEmptyRows('maternalHealthBody', 'maternalHealth'));
                document.getElementById('clearTcmRows').addEventListener('click', () => clearEmptyRows('childTcmBody', 'childTcm'));

                // è‡ªåŠ¨ä¿å­˜è¾“å…¥
                document.addEventListener('input', e => {
                    if (e.target.classList.contains('editable')) {
                        saveCellData(e.target);
                    }
                });
                // å¤±ç„¦ä¿å­˜
                document.addEventListener('blur', e => {
                    if (e.target.classList.contains('editable')) {
                        saveCellData(e.target);
                    }
                }, true);

                // å›¾ç‰‡æŸ¥çœ‹å™¨å…³é—­
                document.getElementById('closeImageViewer').addEventListener('click', () => {
                    document.getElementById('imageViewer').classList.remove('active');
                });
            }

            function saveAllData() {
                tableConfig.forEach(cfg => {
                    document.querySelectorAll(`#${cfg.tbodyId} td`).forEach(td => saveCellData(td));
                });
                updateLastSyncTime();
            }

            function addRow(tbodyId) {
                const tbody = document.getElementById(tbodyId);
                const rowIdx = tbody.children.length;
                const tr = document.createElement('tr');
                for (let c = 0; c < 11; c++) {
                    const td = document.createElement('td');
                    td.className = 'editable';
                    td.setAttribute('contenteditable', 'true');
                    td.setAttribute('data-row', rowIdx);
                    td.setAttribute('data-col', c);
                    const contentDiv = document.createElement('div');
                    contentDiv.className = 'cell-content';
                    td.appendChild(contentDiv);
                    const uploadBtn = document.createElement('button');
                    uploadBtn.className = 'image-upload-btn';
                    uploadBtn.innerHTML = 'ğŸ“·';
                    uploadBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        targetCellForUpload = td;
                        document.getElementById('imageUploadInput').click();
                    });
                    td.appendChild(uploadBtn);
                    tr.appendChild(td);
                }
                tbody.appendChild(tr);
                showMessage('æ–°è¡Œå·²æ·»åŠ ');
            }

            function clearEmptyRows(tbodyId, tableId) {
                const tbody = document.getElementById(tbodyId);
                const rows = Array.from(tbody.children);
                let removed = 0;
                for (let i = rows.length - 1; i >= 0; i--) {
                    const row = rows[i];
                    let empty = true;
                    row.querySelectorAll('td').forEach(td => {
                        const content = td.querySelector('.cell-content');
                        if (content) {
                            if (content.textContent.trim() !== '' || content.querySelectorAll('.image-container').length > 0) {
                                empty = false;
                            }
                        }
                    });
                    if (empty) {
                        row.remove();
                        removed++;
                    }
                }
                if (removed) {
                    // é‡æ–°ç´¢å¼•è¡Œå·
                    tbody.querySelectorAll('tr').forEach((tr, newRow) => {
                        tr.querySelectorAll('td').forEach((td, col) => {
                            td.setAttribute('data-row', newRow);
                            saveCellData(td);
                        });
                    });
                    showMessage(`å·²æ¸…é™¤ ${removed} ä¸ªç©ºè¡Œ`);
                } else {
                    showMessage('æ²¡æœ‰ç©ºè¡Œ');
                }
            }
        })();
    </script>

</body></html>